---
layout: page
---
 
PenTest
========================

>**UTFPR - Universidade Tecnológica Federal do Paraná, campus Campo Mourão**  
>Autor: **Prof. Dr. Luiz Arthur Feitosa dos Santos**  
>E-mail: **<luizsantos@utfpr.edu.br>**  

# Enumeração

Formas de fazer enumeração:

1. A primeira e mais fácil/banal é utilizando o serviço e capturando o *banner*:

```console
$ ftp 192.168.56.104
Connected to 192.168.56.104 (192.168.56.104).
220 (vsFTPd 2.3.4)
Name (192.168.56.104:luiz):
```

ou

```console
$ telnet 192.168.56.104 21
Trying 192.168.56.104...
Connected to 192.168.56.104.
Escape character is '^]'.
220 (vsFTPd 2.3.4)
```
ou

```console
$ nc 192.168.56.104 21
220 (vsFTPd 2.3.4)
USER
331 Please specify the password.
USER ftp
331 Please specify the password.
PASS ftp
```

4. Dá para obter os banners de forma automatizada, tal como:

```console
# nmap --script banner 192.168.56.104
Starting Nmap 7.70 ( https://nmap.org ) at 2020-03-15 00:13 UTC
Nmap scan report for 192.168.56.104
Host is up (0.00041s latency).
Not shown: 977 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
|_banner: 220 (vsFTPd 2.3.4)
22/tcp   open  ssh
|_banner: SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
23/tcp   open  telnet
|_banner: \xFF\xFD\x18\xFF\xFD \xFF\xFD#\xFF\xFD'
25/tcp   open  smtp
|_banner: 220 metasploitable.localdomain ESMTP Postfix (Ubuntu)
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
|_banner: \x01Where are you?
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
|_banner: root@metasploitable:/#
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
|_banner: 220 ProFTPD 1.3.1 Server (Debian) [::ffff:192.168.56.104]
3306/tcp open  mysql
| banner: >\x00\x00\x00\x0A5.0.51a-3ubuntu5\x00\x09\x00\x00\x00Z~-c,O*#\x
|_00,\xAA\x08\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\...
5432/tcp open  postgresql
5900/tcp open  vnc
|_banner: RFB 003.003
6000/tcp open  X11
6667/tcp open  irc
| banner: :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostna
|_me...
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 08:00:27:BE:C0:C2 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 15.49 seconds
```
> Os scripts do nmap estão normalmente disponível no diretório do nmap, tal como ``/usr/share/nmap/scripts/``. Para saber o que o ``script`` faz e como utilizar execute ``nmap --script-help nome``, onde se deve trocar ``nome`` pelo nome do ``script``.


3. Usando fingerprint - que é o método mais confiável, remotamente:

```console
# nmap -sV 192.168.56.104 
Starting Nmap 7.70 ( https://nmap.org ) at 2020-03-15 00:07 UTC
Nmap scan report for 192.168.56.104
Host is up (0.00039s latency).
Not shown: 977 closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login?
514/tcp  open  shell?
1099/tcp open  rmiregistry GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
MAC Address: 08:00:27:BE:C0:C2 (Oracle VirtualBox virtual NIC)
Service Info: Hosts:  metasploitable.localdomain, localhost, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 152.00 seconds
```


# Descobrindo o sistema operacional

```console
# nmap -O 192.168.56.104
Starting Nmap 7.70 ( https://nmap.org ) at 2020-03-15 00:05 UTC
Nmap scan report for 192.168.56.104
Host is up (0.00026s latency).
Not shown: 977 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 08:00:27:BE:C0:C2 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop

OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.87 seconds
```
> Atenção, cruzando os dados obtidos com a enumeração de serviços por *banner* com a enumeração por *banner* é possível ter mais certeza a respeito do serviço real que está em execução em cada porta.

# Pesquisando os vulnerabilidades para os softwares descobertos na enumeração:

1. O método mais comum é pesquisando no Google utilizando como entrada o *banner* obtido, tal como ``ProFTPD 1.3.1``.

Dentro das pesquisas dois sítios que serão retornados nestas buscas dois que são bem úteis são:

* <https://www.securityfocus.com> - Esse é mais focado em dar descrições a respeito da vulnerabilidade, 
* <https://www.exploit-db.com> - Esse normalmente fornece o *exploit*.

2. Também dá para usar o Nessus/OpenVAS